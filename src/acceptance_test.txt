#!/bin/sh
#######################################################################
## - unit-test-b.sh
## - Assignment 2 - Metronome
## - @reference - item b) on page 7 of assignment specification
## - @author Gerald.Hurdle@AlgonquinCollege.com
#######################################################################
#Unit Test 1
echo "********************************************"
echo "Unit Test [1] \n./metronome"
echo "Expected: ussage message and process terminates (gracefully)"
./metronome
sleep 15


#Unit Test 2
echo "********************************************"
echo "Unit Test [2] \n./metronome 120 2 4 &"
echo "Expected:1 measure per second. I will use this unit-test to verify the correct cadence of your metronome."
./metronome 120 2 4 &
sleep 15

echo "\n"

#Unit Test 3
echo "********************************************"
echo "Unit Test [3] \n cat /dev/local/metronome"
echo "Expected: metronome runs at [metronome: 120 beats/min, time signature 2/4, secs-per-interval: 0.25, nanoSecs: 250000000] " 
cat /dev/local/metronome
sleep 15

echo "\n"

#Unit Test 4
echo "********************************************"
echo "Unit Test [4] \n cat /dev/local/metronome-help"
echo "Expected: information regarding the metronome resmgr’s API, as seen above."
cat /dev/local/metronome-help
sleep 15

echo "\n"

#Unit Test 5
echo "********************************************"
echo "Unit Test [5] \n echo set 100 2 4 > /dev/local/metronome"
echo "Expected: metronome regmgr changes settings to: 100 bpm in 2/4 time; run-time behaviour of metronome changes to 100 bpm in 2/4 time."
echo set 100 2 4 > /dev/local/metronome
sleep 15

echo "\n"

#Unit Test 6
echo "********************************************"
echo "Unit Test [6] \n cat /dev/local/metronome\n"
echo "Expected:  [metronome: 100 beats/min, time signature 2/4, secs-per- interval: 0.30, nanoSecs: 300000000]"
cat /dev/local/metronome
sleep 15

echo "\n"

#Unit Test 7
echo "********************************************"
echo "Unit Test [7] \n echo set 200 5 4 > /dev/local/metronome"
echo "Expected: metronome regmgr changes settings to: 200 bpm in 5/4 time; run-time behaviour of metronome changes to 200 bpm in 5/4 time."
echo set 200 5 4 > /dev/local/metronome
sleep 15

echo "\n"

#Unit Test 8
echo "********************************************"
echo "Unit Test [8] \n cat /dev/local/metronome\n"
echo "Expected: [metronome: 200 beats/min, time signature 5/4, secs-per- interval: 0.15, nanoSecs: 150000000]"
cat /dev/local/metronome
sleep 15

#Unit Test 9
echo "********************************************"
echo "Unit Test [9] \n echo stop > /dev/local/metronome\n"
echo "Expected: metronome stops running; metronome resmgr is still running as a process: pidin | grep metronome."
echo stop > /dev/local/metronome 
sleep 15

#Unit Test 10
echo "********************************************"
echo "Unit Test [10] \n start > /dev/local/metronome\n "
echo "Expected:  metronome starts running again at 200 bpm in 5/4 time, which is the last setting;"
echo "metronome resmgr is still running as a process: pidin | grep metronome."
echo start > /dev/local/metronome
sleep 15

echo "\n"

#Unit Test 11
echo "********************************************"
echo "Unit Test [11] \n cat /dev/local/metronome\n"
echo "Expected: [metronome: 200 beats/min, time signature 5/4, secs-per- interval: 0.15, nanoSecs: 150000000]"
cat /dev/local/metronome
sleep 15

echo "\n"

#Unit Test 12
echo "********************************************"
echo "Unit Test [12] \n echo stop > /dev/local/metronome\n"
echo "Expected: metronome stops running; metronome resmgr is still running as a process: pidin | grep metronome."
echo stop > /dev/local/metronome
sleep 15

echo "\n"

#Unit Test 13
echo "********************************************"
echo "Unit Test [12] \n echo stop > /dev/local/metronome\n"
echo "Expected: metronome remains stopped; metronome resmgr is still running as a process: pidin | grep metronome."
echo stop > /dev/local/metronome
sleep 15

echo "\n"

#Unit Test 14
echo "********************************************"
echo "Unit Test [14] \n echo start > /dev/local/metronome\n"
echo "Expected: metronome starts running again at 200 bpm in 5/4 time, which is the last setting;"
echo "metronome resmgr is still running as a process: pidin | grep metronome"
echo start > /dev/local/metronome
sleep 15

echo "\n"

#Unit Test 15
echo "********************************************"
echo "Unit Test [15] \n echo start > /dev/local/metronome\n"
echo "Expected: metronome is still running again at 200 bpm in 5/4 time, which is the last setting;"
echo "metronome resmgr is still running as a process: pidin | grep metronome"
echo start > /dev/local/metronome
sleep 15

echo "\n"

#Unit Test 16
echo "********************************************"
echo "Unit Test [16] \n echo cat /dev/local/metronome\n"
echo "Expected: [metronome: 200 beats/min, time signature 5/4, secs-per- interval: 0.15, nanoSecs: 150000000]"
cat /dev/local/metronome
sleep 15

echo "\n"

#Unit Test 17
echo "********************************************"
echo "Unit Test [17] \n echo pause 3 > /dev/local/metronome\n"
echo "Expected: metronome continues on next beat (not next measure)"
echo pause 3 > /dev/local/metronome
sleep 15

echo "\n"

#Unit Test 18
echo "********************************************"
echo "Unit Test [18] \n echo pause 10 > /dev/local/metronome\n"
echo "Expected:  properly formatted error message, and metronome continues to run."
echo pause 10 > /dev/local/metronome
sleep 15

echo "\n"

#Unit Test 19
echo "********************************************"
echo "Unit Test [19] \n echo bogus > /dev/local/metronome\n"
echo "Expected:  properly formatted error message, and metronome continues to run."
echo bogus > /dev/local/metronome
sleep 15

echo "\n"

#Unit Test 20
echo "********************************************"
echo "Unit Test [20] \n echo set 120 2 4 > /dev/local/metronome\n"
echo "Expected: 1 measure per second. I will use this unit-test to verify the correct cadence of your metronome."
echo "Let your metronome run for 3 to 5 seconds so we can observe the metronome’s run-time behaviour."
echo set 120 2 4 > /dev/local/metronome
sleep 15

echo "\n"

#Unit Test 21
echo "********************************************"
echo "Unit Test [20] \n cat /dev/local/metronome\n"
echo "Expected: [metronome: 120 beats/min, time signature 2/4, secs-per-interval: 0.25, nanoSecs: 250000000]"
cat /dev/local/metronome
sleep 15

echo "\n"

#Unit Test 22
echo "********************************************"
echo "Unit Test [22] \n cat /dev/local/metronome-help\N"
echo "Expected: information regarding the metronome resmgr’s API, as seen above."
cat /dev/local/metronome-help
sleep 15

echo "\n"

#Unit Test 23
echo "********************************************"
echo "Unit Test [24] \n cat /dev/local/metronome\n"
echo "Expected: [metronome: 120 beats/min, time signature 2/4, secs-per-interval: 0.25, nanoSecs: 250000000]"
cat /dev/local/metronome
sleep 15

echo "\n"

#Unit Test 25
echo "********************************************"
echo "Unit Test [25] \n echo Writes-Not-Allowed > /dev/local/metronome-help"
echo "Expected: properly formatted error message, and metronome continues to run."
echo Writes-Not-Allowed > /dev/local/metronome-help
sleep 15

echo "\n"

#Unit Test 26
echo "********************************************"
echo "Unit Test [26] \n echo quit > /dev/local/metronome && pidin | grep metronome"
echo "Expected: metronome gracefully terminates."
echo quit > /dev/local/metronome && pidin | grep metronome
sleep 15

echo "********************************************"
echo quit > /dev/local/metronome
exit 0